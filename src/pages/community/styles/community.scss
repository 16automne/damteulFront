@import '../../../styles/_config';

// 1. 레이아웃 컨테이너
.communityContainer {
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden; // 전체 스크롤 방지
  width: 100%;
  max-width: $mobileMaxWidth;
  margin: 0 auto;
  padding-top: calc(3.5rem + env(safe-area-inset-top)); 
  // 3.5rem: 헤더 상단 높이, env(safe-area-inset-top): 안전하지 않은 영역의 높이

  .commBaseLayout {
    height: auto !important; // mixin의 100dvh 해제
    min-height: 0 !important; // mixin의 100dvh 해제
    flex-shrink: 0; // 어떤 일이 있어도 찌그러지지X
  }
}

.commRecSection { @include fontText01; }

// 2. 카테고리 리스트 (병합 및 최적화)
.commCateList {
  width: 100%; // 100vw에서 100%로 수정하여 우측 여백 방지
  display: flex;
  overflow-x: auto;
  white-space: nowrap;
  padding: 2rem 0 1.8rem;
  gap: 1rem;
  -webkit-overflow-scrolling: touch;
  &::-webkit-scrollbar { display: none; }

  .commCate {
    flex: 0 0 auto;
    
    .commCateWrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 4.5rem;

      .commCateLabel { 
        @include fontText04; 
        margin-top: 0.2rem; // 아이콘과의 간격
      }
      
      .commCateIcon {
        width: 3.5rem; height: 3.5rem;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 0.2rem solid $colorSmGray;
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
        transition: all 0.2s ease; // 부드러운 상태 변화
      }
    }

    // 카테고리별 활성화 상태 (nth-child 반복 제거 후 통합 관리)
    $cate-colors: (
      1: $colorEtcRed,
      2: $colorEtcOrange,
      3: $colorEtcYellow,
      4: $colorEtcLgGreen,
      5: $colorEtcSkyBlue,
      6: $colorEtcBlue,
      7: $colorEtcPurple
    );

    @each $index, $color in $cate-colors {
      &:nth-child(#{$index}).active {
        .commCateLabel { @include fontText03; color: $color; font-weight: bold; }
        .commCateIcon { 
          border-color: $color;
          svg { color: $color; fill: $color; } 
        }
      }
    }
  }
}

// 3. 이미지 피드 섹션
.comFeedSection {
  flex-grow: 1; // 상단을 제외한 남은 모든 세로 공간을 차지함
  overflow-y: auto;
  width: 100%;
  &::-webkit-scrollbar {
    width: 0; // 스크롤바 숨기기
  }
  
  .comFeedWrap {
    width: 100%;
    display: flex; flex-wrap: wrap;
    
    .comFeedItem {
      width: 50%; // 2열 구성
      box-sizing: border-box;
      
      .imgBox {
        position: relative; // .feedInfo의 기준
        width: 100%;
        aspect-ratio: 1 / 1; // 이미지 박스 정사각형
        overflow: hidden;

        img {
          width: 100%; height: 100%;
          object-fit: cover;
          display: block; // 이미지 하단 미세 여백 제거
        }

        /* 더보기 버튼 */
        .moreIcon{
          padding: 0.25rem;
          position: absolute; 
          top: 0.8rem; right: 0.8rem;
          z-index: 10;
          cursor: pointer;

          span{
            svg {font-size: 1.8rem;}
          }
        }

        /* 하트, 댓글 */
        .feedInfo {
          overflow: hidden;
          position: absolute; 
          bottom: 0.8rem; left: 0.8rem;
          display: flex; flex-direction: column; // 세로
          gap: 0.3rem; //위아래 간격
          z-index: 10;

          span{
            padding: 0.3rem 0.3rem 0rem 0rem;
            svg {font-size: 0.9rem}
          }
        }
        
        .feedInfo span, .moreIcon span {
          @include fontText04;
          color: $colorWhite;
          display: flex;
          align-items: center;
          justify-content: flex-start;
          gap: 4px;
          /* 밝은 이미지 위에서도 잘 보이도록 그림자 추가 */
          text-shadow: 0rem 0rem 0.3rem rgba(0, 0, 0, 0.6);

          svg {fill: $colorWhite;} // 아이콘 색상 강제 적용
        }
      }
    }
  }
}